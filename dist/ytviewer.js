!async function(){if(window.YTViewer_Player=function(){let e=document.createElement("div");e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.width="auto",e.style.height="auto",e.style.zIndex="10000",e.style.backgroundColor="rgba(0, 0, 0, 0.3)";let t=document.createElement("div");t.style.position="absolute",t.style.top="10px",t.style.left="10px",t.style.width="8rem",t.style.height="1.8rem",t.style.fontSize="1.5rem",t.style.backgroundColor="#33aa33",t.style.color="#eeeeee",t.style.paddingLeft="1rem",t.style.cursor="pointer",t.style.borderRadius="1rem",t.innerHTML="YTViewer",t.addEventListener("click",(e=>{if(window.location.href.indexOf("?")>=0){let e=new URLSearchParams(window.location.href.substring(window.location.href.lastIndexOf("?")+1)).get("v");if(null!=e)return void window._ytviewer.play(e)}alert("YTViewer - click on a youtube thumbnail to play the video.\n\nAuthor: Thomas Tschurtschenthaler")})),e.appendChild(t),document.body.appendChild(e);let l=null,i=null,o=null,r=()=>{null!=l&&(e.removeChild(l),e.removeChild(i),e.style.width="auto",e.style.height="auto",t.style.display="inline",l=null,i=null,o=null)};return{isplaying:e=>e==o,play:async(n,s,d)=>{if(r(),null==s){let t=null;try{t=await ytdl.getInfo(n,{})}catch(t){return void(e.innerHTML="Error:"+t)}console.log("videoInfo",t);let l=["144p","240p","360p","480p","720p","1080p","1440p","2160p","4320p"],i=(e,t)=>{let i=l.indexOf(e.qualityLabel);return l.indexOf(t.qualityLabel)-i},o=t.formats.filter((e=>e.hasAudio&&e.hasVideo)).sort(i);console.log("formatvideo",o),s=o[0].url,d={ytinfo:t,formats:t.formats.filter((e=>!e.isHLS)).sort(i)}}o=n,e.style.width="100%",e.style.height="100%",t.style.display="none",l=document.createElement("video"),l.setAttribute("controls","true"),l.setAttribute("width","80%"),l.setAttribute("height","80%"),l.style.marginLeft="10%",l.style.marginTop="5%";let a=document.createElement("source");a.setAttribute("src",s),a.setAttribute("type","video/mp4"),l.appendChild(a),e.appendChild(l),l.load(),l.play(),i=document.createElement("div"),i.style.position="absolute",i.style.top="10px",i.style.left="10px",i.style.width="10rem",i.style.height="1.8rem",e.appendChild(i);let y=document.createElement("div");y.style.position="absolute",y.style.top="0px",y.style.left="0px",y.style.width="2.4rem",y.style.height="1.8rem",y.style.fontSize="1.5rem",y.style.backgroundColor="#aa3333",y.style.color="#eeeeee",y.style.cursor="pointer",y.style.borderRadius="1rem",y.innerHTML="<div style='position:relative; left:0.8rem; top:-0.1rem'>x</div>",y.setAttribute("title","Close"),y.addEventListener("click",(e=>{r()})),i.appendChild(y);let u=document.createElement("div");u.style.position="absolute",u.style.top="0px",u.style.left="3rem",u.style.width="2.4rem",u.style.height="1.8rem",u.style.fontSize="1.5rem",u.style.backgroundColor="#aa8822",u.style.color="#eeeeee",u.style.cursor="pointer",u.style.borderRadius="1rem",u.setAttribute("title","Minimize");let h="<div style='position:relative; left:0.6rem'>—</div>";u.innerHTML=h;let p=!1;if(u.addEventListener("click",(t=>{p?(u.innerHTML=h,e.style.width="100%",e.style.height="100%",l.style.display="inline"):(u.innerHTML="<div style='position:relative; left:0.4rem; top:-0.2rem;'>＋</div>",e.style.width="auto",e.style.height="auto",l.style.display="none"),p=!p})),i.appendChild(u),null!=d&&d.formats.length>0){let e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="6rem",e.style.width="2.4rem",e.style.height="1.8rem",e.style.fontSize="1.5rem",e.style.backgroundColor="#8822aa",e.style.color="#eeeeee",e.style.cursor="pointer",e.style.borderRadius="1rem",e.setAttribute("title","Download"),e.innerHTML="<div style='position:relative; left:0.8rem; top:-0.1rem'>↧</div>",e.addEventListener("click",(t=>{let l=[],o=d.formats.filter((e=>e.hasAudio&&e.hasVideo)),r=d.formats.filter((e=>!e.hasAudio&&e.hasVideo)),n=d.formats.filter((e=>e.hasAudio&&!e.hasVideo));o.length>0&&(o[0]._dltitle="_Video_and_Audio",l.push(o[0])),r.length>0&&(r[0]._dltitle="_Video",l.push(r[0])),n.length>0&&(n[0]._dltitle="_Audio",l.push(n[0])),e.innerHTML="",l.forEach((t=>{let l=document.createElement("a");l.innerHTML=d.ytinfo.videoDetails.title+t._dltitle+".mp4",l.href=t.url,l.style.display="block",l.download=d.ytinfo.videoDetails.title+t._dltitle+".mp4",l.style.color="#eeeeee",l.style.fontSize="1rem",l.style.marginBottom="0.4rem",l.style.marginTop="0.4rem",l.style.marginLeft="0.4rem",l.style.marginRight="0.4rem",e.appendChild(l),e.style.width="auto",e.style.height="auto",i.style.width="100rem"}))})),i.appendChild(e)}}}},window.location.host.indexOf("youtube.com")<0)alert("Use YTViewer on Youtube pages www.youtube.com or m.youtube.com.");else if(null==window._ytviewer&&(null!=document.body&&document.body.addEventListener("click",(async e=>{if(e.target.closest('a[href^="/watch?"]')||e.target.closest("ytd-thumbnail")){let t=e.target.closest('a[href^="/watch?"]').href;console.log("videoLink",t);let l=new URLSearchParams(t.substring(t.lastIndexOf("?")+1)).get("v");if(console.log("videoid",l),window._ytviewer.isplaying(l))return;e.preventDefault(),e.stopPropagation(),window._ytviewer.play(l)}}),!0),window._ytviewer=window.YTViewer_Player(),console.log("ytviewer started")),window.location.href.indexOf("?")>=0){let e=new URLSearchParams(window.location.href.substring(window.location.href.lastIndexOf("?")+1)).get("v");null!=e&&window._ytviewer.play(e)}}();